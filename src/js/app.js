import Table from "./tablecreation";
import getRandomValue from "./randomfunc"; // –∏–º–ø–æ—Ä—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
import goblin_small from "../../pic/goblin_small.png"; // –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–æ—Å—å–± –ø–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏ webpack, –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –µ–≥–æ

document.addEventListener("DOMContentLoaded", () => {
  const btnStart = document.querySelector(".btns-start"); // –Ω–∞—Ö–æ–¥–∏–º –∫–Ω–æ–ø–∫—É –ù–∞—á–∞—Ç—å –∏ –ø–æ–º–µ—â–∞–µ–º –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é btnStart
  const btnReset = document.querySelector(".btns-reset"); // –Ω–∞—Ö–æ–¥–∏–º –∫–Ω–æ–ø–∫—É –°–±—Ä–æ—Å –∏ –ø–æ–º–µ—â–∞–µ–º –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é btnReset
  const imgToRemove = document.querySelector("img"); //—Ç.–∫. –ø–æ —Å—É—Ç–∏ —É –Ω–∞—Å –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç 1 –≥–æ–±–ª–∏–Ω, —Ç–æ –ø–æ–º–µ—â–∞–µ–º –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–µ—Ä–≤—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π

  const gameField = document.querySelector(".game_field"); // –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gameField –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å div –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
  const totalSuccess = document.querySelector(".cells_success"); // –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –ø–æ–¥—Å—á–µ—Ç —É—Å–ø–µ—à–Ω—ã—Ö –∫–ª–∏–∫–æ–≤ –ø–æ –≥–æ–±–ª–∏–Ω—É
  const totalMiss = document.querySelector(".cells_miss"); // –∑–¥–µ—Å—å –±—É–¥–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –ø–æ–¥—Å—á–µ—Ç –ø—Ä–æ–º–∞—Ö–æ–≤
  const res = document.querySelector(".result"); // –Ω–µ–∫–∏–π –≤—Å–ø–ª—ã–≤–∞—é—â–∏–π div —Å –ø–æ—Å–ª–µ–¥—É—é—â–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º –æ –≤—ã–∏–≥—Ä—ã—à–µ –∏–ª–∏ –ø—Ä–æ–∏–≥—Ä—ã—à–µ

  // –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ —Å–±—Ä–æ—Å, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
  btnReset.addEventListener("click", () => {
    location.reload();
  });

  btnStart.addEventListener("click", () => {
    const rowVal = document.querySelector("#number1").value; //–ø–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –ø–æ–ª—è –≤–≤–æ–¥–∞ –∫–æ–ª-–≤–∞ —Å—Ç—Ä–æ–∫
    const colVal = document.querySelector("#number2").value; //–ø–æ–ª—É—á–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –ø–æ–ª—è –≤–≤–æ–¥–∞ –∫–æ–ª-–≤–∞ —Å—Ç–æ–ª–±—Ü–æ–≤

    let gameOver = false; // –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gameOver –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –∏–≥—Ä–∞ –Ω–µ –æ–∫–æ–Ω—á–µ–Ω–∞, –∞ –∑–Ω–∞—á–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ false

    // —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–æ–≤
    function counter(e) {
      // –µ—Å–ª–∏ –º—ã –∫–ª–∏–∫–Ω—É–ª–∏ –ø–æ –≥–æ–±–ª–∏–Ω—ã –∏ –ø–æ–ø–∞–ª–∏, —Ç–æ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —á–∏—Å–ª–æ —É—Å–ø–µ—à–Ω—ã—Ö –∫–ª–∏–∫–æ–≤, –∏–Ω–∞—á–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º —á–∏—Å–ª–æ –Ω–µ—É—Å–ø–µ—à–Ω—ã—Ö
      if (e.target.closest("img")) {
        totalSuccess.textContent = Number(totalSuccess.textContent) + 1; //–ø–æ–¥—Å—á–µ—Ç —É—Å–ø–µ—à–Ω—ã—Ö –∫–ª–∏–∫–æ–≤ –∏ –∑–∞–ø–∏—Å—å –≤ –æ—Ç–≤–µ–¥–µ–Ω–Ω—ã–π div
        if (Number(totalSuccess.textContent) == 10) {
          let hex = "ü•≥".codePointAt(0).toString(16);
          let emo = String.fromCodePoint("0x" + hex);
          res.style.display = "block";
          res.style.color = "green";
          res.textContent = "You win!!" + emo;
          gameOver = true; // –∫–∞–∫ —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ —É—Å–ø–µ—à–Ω—ã—Ö –∫–ª–∏–∫–æ–≤ –¥–æ—Å—Ç–∏–≥–ª–æ 10 –º–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gameOver= true
        }
      } else {
        totalMiss.textContent = Number(totalMiss.textContent) + 1; //–ø–æ–¥—Å—á–µ—Ç –ù–ï —É—Å–ø–µ—à–Ω—ã—Ö –∫–ª–∏–∫–æ–≤ –∏ –∑–∞–ø–∏—Å—å –≤ –æ—Ç–≤–µ–¥–µ–Ω–Ω—ã–π div
        if (Number(totalMiss.textContent) == 5) {
          let hex = "üòü".codePointAt(0).toString(16);
          let emo = String.fromCodePoint("0x" + hex);
          res.style.display = "block";
          res.style.color = "red";
          res.textContent = "You lose" + emo;
          gameOver = true; // –∫–∞–∫ —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ –ù–ï —É—Å–ø–µ—à–Ω—ã—Ö –∫–ª–∏–∫–æ–≤ –¥–æ—Å—Ç–∏–≥–ª–æ 5 –º–µ–Ω—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π gameOver= true
        }
      }
    }
    // –æ–±—Ä–∞–±–æ—Ç—á–∫–∏ —Å–æ–±—ã—Ç–∏—è "–ø–æ–≤–µ—à–∞–Ω" –Ω–∞ –∏–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ, —á—Ç–æ —Å–æ–∑–¥–∞–µ—Ç –Ω–µ–∫–∏–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫
    gameField.addEventListener("click", counter);

    if (!rowVal || !colVal) {
      alert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è");
    } else {
      btnStart.disabled = true // –∑–∞–ø—Ä–µ—â–∞–µ–º –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –ù–∞—á–∞—Ç—å
      const table = new Table();
      table.gameFieldCleaning(); // –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥ –æ—á–∏—Å—Ç–∫–∏ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è
      table.gameFieldCreation(rowVal, colVal); // –≤—ã–∑—ã–≤–∞–µ–º –º–µ—Ç–æ–¥, –≤ –∫–æ—Ç–æ—Ä—É—é –ø–µ—Ä–µ–¥–∞–µ–º —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –Ω–∞—à–µ–≥–æ –∏–≥—Ä–æ–≤–æ–≥–æ –ø–æ–ª—è

      let randomValue = 0; // –∑–∞–¥–∞–µ–º –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ —è—á–µ–π–∫–∏ –∫–∞–∫ –ø–µ—Ä–≤—ã–π –∏–Ω–¥–µ–∫—Å –º–∞—Å—Å–∏–≤–∞, —Å –∫–æ–æ—Ä—ã–º –∑–∞—Ç–µ–º –±—É–¥–µ–º —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –Ω–æ–≤–æ–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

      const img = document.createElement("img"); // —Å–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç image - –Ω–∞—à –≥–æ–±–ª–∏–Ω
      const numCol = document.querySelectorAll(".cells"); // –Ω–∞—Ö–æ–¥–∏–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã div- —è—á–µ–π–∫–∏

      //–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é sizeField –ø–æ–º–µ—â–∞–µ–º —Ä–∞–∑–º–µ—Ä –º–∞—Å—Å–∏–≤–∞ - 1 —ç–ª–µ–º–µ–Ω—Ç, —Ç–∫. –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —Å 0.
      // –ú—ã –µ–≥–æ —é—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è- —è—á–µ–π–∫–∏
      const sizeField = numCol.length;

      img.src = `${goblin_small}`; //–¥–æ–±–∞–≤–ª—è–µ–º –∞—Ç—Ç—Ä–∏–±—É—Ç –≤ –≤–∏–¥–µ –ø—É—Ç–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è

      let randomValue_new = getRandomValue(sizeField); //–ø–æ–ª—É—á–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ id –æ—Ç 0 –¥–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è —è—á–µ–π–∫–∏ —Ç–∞–±–ª–∏—Ü—ã

      const intervalId = setInterval(() => {
        //    const imgToRemove = document.querySelector("img"); //—Ç.–∫. –ø–æ —Å—É—Ç–∏ —É –Ω–∞—Å –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç 1 –≥–æ–±–ª–∏–Ω, —Ç–æ –ø–æ–º–µ—â–∞–µ–º –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–µ—Ä–≤—ã–π –Ω–∞–π–¥–µ–Ω–Ω—ã–π
        // –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ, —Ç–æ —É–¥–∞–ª–µ–º –µ–≥–æ —Å–Ω–∞—á–∞–ª–∞
        if (imgToRemove) {
          imgToRemove.remove();
        }

        // –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –≥–æ–±–ª–∏–Ω "–Ω–µ –ø–∞–¥–∞–ª" –≤ —Ç—É –∂–µ —Å–∞–º—É—é —è—á–µ–π–∫—É, —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –Ω–∞—à–µ –Ω–æ–≤–æ–µ —Å–ª—É—á–∞–π–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å –ø—Ä–æ—à–ª—ã–º –∏,
        // –µ—Å–ª–∏ –æ–Ω–∏ —Ä–∞–∑–Ω—ã–µ, —Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –≥–æ–±–ª–∏–Ω–∞ –≤ —Å–æ–æ—Ç–≤—Ç–µ—Å–≤—É—é—â—É—é —è—á–µ–π–∫—É- div
        randomValue = randomValue_new;
        numCol[randomValue].append(img);

        //–ø–æ–ª—É—á–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ id –æ—Ç 0 –¥–æ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è —è—á–µ–π–∫–∏ —Ç–∞–±–ª–∏—Ü
        while (randomValue == randomValue_new)
          randomValue_new = getRandomValue(sizeField);
        randomValue = randomValue_new;

        // –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–∫–∞–∑–∞ –≥–æ–±–ª–∏–Ω–∞ —Å–ª—É—á–∞–π–Ω—ã–º –ø–æ—Ä—è–¥–∫–æ–º –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ 10 —Å–µ–∫
        /*setTimeout(() => {
        clearInterval(showInterval);
    }, 3000);*/
        // –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–≥—Ä—É, –∫–æ–≥–¥—ã gameOver= true –∏ —É–¥–∞–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–æ–±—ã—Ç–∏—è
        if (gameOver) {
          clearInterval(intervalId);
          gameField.removeEventListener("click", counter);
        }
      }, 1000);
    }
  });
});
